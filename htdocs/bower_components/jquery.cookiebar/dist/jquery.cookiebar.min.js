/*
 * Copyright (C) 2012 PrimeBox (info@primebox.co.uk)
 * 
 * This work is licensed under the Creative Commons
 * Attribution 3.0 Unported License. To view a copy
 * of this license, visit
 * http://creativecommons.org/licenses/by/3.0/.
 * 
 * Documentation available at:
 * http://www.primebox.co.uk/projects/cookie-bar/
 * 
 * When using this software you use it at your own risk. We hold
 * no responsibility for any damage caused by using this plugin
 * or the documentation provided.
 */
 !function(a){a.cookieBar=function(b,c){if("cookies"==b)var d="cookies";else if("set"==b)var d="set";else var d=!1;var e={message:"We use cookies to track usage and preferences.",acceptButton:!0,acceptText:"I Understand",acceptFunction:!1,declineButton:!1,declineText:"Disable Cookies",declineFunction:!1,policyButton:!1,policyText:"Privacy Policy",policyFunction:!1,policyURL:"/privacy-policy/",autoEnable:!0,acceptOnContinue:!1,expireDays:365,forceShow:!1,effect:"slide",element:"body",append:!1,fixed:!1,bottom:!1,customClass:"",zindex:"",redirect:String(window.location.href),domain:String(window.location.hostname),referrer:String(document.referrer)},b=a.extend(e,b),f=new Date;f.setTime(f.getTime()+24*b.expireDays*60*60*1e3),f=f.toGMTString();var g,h,i="cb-enabled={value}; expires="+f+"; path=/",j="",k=document.cookie.split("; ");for(g=0;g<k.length;g++)h=k[g].split("="),"cb-enabled"==h[0]&&(j=h[1]);if(""==j&&"cookies"!=d&&b.autoEnable&&(j="enabled",document.cookie=i.replace("{value}","enabled")),b.acceptOnContinue&&b.referrer.indexOf(b.domain)>=0&&-1==String(window.location.href).indexOf(b.policyURL)&&"cookies"!=d&&"set"!=d&&"accepted"!=j&&"declined"!=j&&(d="set",c="accepted"),"cookies"==d)return"enabled"==j||"accepted"==j?!0:!1;if("set"==d&&("accepted"==c||"declined"==c))return document.cookie=i.replace("{value}",c),"accepted"==c?!0:!1;var l=b.message.replace("{policy_url}",b.policyURL);if(b.acceptButton)var m='<a href="" class="cb-enable">'+b.acceptText+"</a>";else var m="";if(b.declineButton)var n='<a href="" class="cb-disable">'+b.declineText+"</a>";else var n="";if(b.policyButton)var o='<a href="'+b.policyURL+'" class="cb-policy">'+b.policyText+"</a>";else var o="";if(b.fixed)if(b.bottom)var p=' class="fixed bottom '+b.customClass+'"';else var p=' class="fixed '+b.customClass+'"';else var p=' class="'+b.customClass+'"';if(""!=b.zindex)var q=' style="z-index:'+b.zindex+';"';else var q="";(b.forceShow||"enabled"==j||""==j)&&(b.append?a(b.element).append('<div id="cookie-bar"'+p+q+"><p>"+l+m+n+o+"</p></div>"):a(b.element).prepend('<div id="cookie-bar"'+p+q+"><p>"+l+m+n+o+"</p></div>")),a("#cookie-bar .cb-enable").click(function(){return document.cookie=i.replace("{value}","accepted"),b.acceptFunction&&"function"==typeof b.acceptFunction&&b.acceptFunction(),"enabled"==j||"accepted"==j||b.redirect===!1?("slide"==b.effect?a("#cookie-bar").slideUp(300,function(){a("#cookie-bar").remove()}):"fade"==b.effect?a("#cookie-bar").fadeOut(300,function(){a("#cookie-bar").remove()}):a("#cookie-bar").hide(0,function(){a("#cookie-bar").remove()}),!1):void(window.location=b.redirect)}),a("#cookie-bar .cb-disable").click(function(){var c=new Date;for(c.setTime(c.getTime()-864e6),c=c.toGMTString(),k=document.cookie.split("; "),g=0;g<k.length;g++)h=k[g].split("="),h[0].indexOf("_")>=0?document.cookie=h[0]+"=0; expires="+c+"; domain="+b.domain.replace("www","")+"; path=/":document.cookie=h[0]+"=0; expires="+c+"; path=/";return document.cookie=i.replace("{value}","declined"),b.declineFunction&&"function"==typeof b.declineFunction&&b.declineFunction(),"enabled"!=j||"accepted"==j||b.redirect===!1?("slide"==b.effect?a("#cookie-bar").slideUp(300,function(){a("#cookie-bar").remove()}):"fade"==b.effect?a("#cookie-bar").fadeOut(300,function(){a("#cookie-bar").remove()}):a("#cookie-bar").hide(0,function(){a("#cookie-bar").remove()}),!1):void(window.location=b.redirect)}),a("#cookie-bar .cb-policy").click(function(){b.policyFunction&&"function"==typeof b.policyFunction&&b.policyFunction()})}}(jQuery);